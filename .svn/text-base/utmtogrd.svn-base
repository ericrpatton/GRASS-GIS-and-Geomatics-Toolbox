#! /bin/sh

trap 'echo -e "\nUser break! Exiting..." ; rm -r *GRD ; exit 1' 2 3 15

echo -e -n "\nEnter a search string for the utm file(s) to grid: "
read PATTERN
echo -e -n "\nEnter in grid resolution required: "
read RES

for MAP in `ls $PATTERN` ; do

# Run GMT program minmax to find the extent of the dataset.

	echo -e "\n\n================================================"
	echo -e -n "\nCalculating map extents, please standby..."
	BOUNDS=`minmax $MAP -I$RES`
	echo -e -n "\nDone."
	echo -e "\n\n"
	echo -e "Running xyz2grd on $MAP..."

	xyz2grd $MAP $BOUNDS -I1 -F -V -N-9999 -G$MAP.GRD

	echo -e "\nImporting Binary Array..."
	r.in.bin -fh input=$MAP.GRD output=$MAP.grd
	
	if [ $? -ne 0 ] ; then
		echo -e "\n\n$SCRIPT: r.in.bin import failed. Exiting."
		rm -f $MAP.GRD		
		exit 1	

	else
		echo -e "\nImport to Grass was successful!"
		rm -f $MAP.GRD

	fi



done

exit 0 
